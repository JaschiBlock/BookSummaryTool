<!doctype html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Zeichenzähler (ohne Enter) mit linearem Kapitelziel</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <h1>Zeichenzähler (ohne Enter) mit linearem Kapitelziel</h1>

  <div class="layout">
    <!-- linke Spalte: Kapitel- & Speichereinstellungen -->
    <div class="left">
      <div class="grid">
        <div class="card">
          <div class="row">
            <label for="chapters">Kapitelanzahl (N)</label>
            <input id="chapters" type="number" min="1" step="1" value="30" />

            <label for="currentChapter">Aktuelles Kapitel (k)</label>
            <div id="chapterControls" class="chapter-ctrls">
              <button id="prevChapter" class="arrow" title="Kapitel zurück">←</button>
              <input id="currentChapter" type="number" min="1" step="1" value="1" style="max-width:100px" />
              <button id="nextChapter" class="arrow" title="Kapitel vor">→</button>
              <span class="inline-meta">/ <span id="chaptersTotalDisplay">30</span></span>
            </div>

            <label for="minTotal">Gesamt-Minimum Zeichen (ohne Enter, gesamtes Buch)</label>
            <input id="minTotal" type="number" min="0" step="1" value="1100" />

            <label for="maxTotal">Gesamt-Maximum Zeichen (ohne Enter, gesamtes Buch)</label>
            <input id="maxTotal" type="number" min="0" step="1" value="1500" />

            <div class="meta">
              Linear: Bis Kapitel k sind k/N des Gesamt-Min/Max erlaubt.
            </div>
          </div>

          <div class="row" style="margin-top:10px">
            <label for="autosaveToggle">Autosave</label>
            <div class="flex">
              <select id="autosaveToggle">
                <option value="on" selected>Ein</option>
                <option value="off">Aus</option>
              </select>
              <label for="interval" style="margin:0 0 0 8px">Intervall (Sek.)</label>
              <input id="interval" type="number" min="2" step="1" value="5" style="max-width:120px" />
            </div>
            <div class="flex" style="margin-top:8px">
              <button id="save" class="btn">Jetzt speichern</button>
              <button id="export" class="btn secondary">Export .txt</button>
              <input id="importFile" type="file" accept=".txt,.md,.rtf,.csv,.json" style="display:none" />
              <button id="importBtn" class="btn secondary">Import .txt/.md</button>
              <button id="clear" class="btn secondary">Alles löschen</button>
            </div>

            <div class="flex" style="margin-top:8px">
              <button id="lsExport" class="btn secondary">LocalStorage sichern</button>
              <button id="lsImportBtn" class="btn secondary">LocalStorage laden</button>
              <input id="lsImportFile" type="file" accept="application/json" style="display:none" />
            </div>
            <div class="warn-note">
              ⚠ Achtung: Der Stand liegt nur lokal im Browser. Er kann verloren gehen …
            </div>

            <div id="saveInfo" class="meta"></div>
          </div>

          <div class="row" style="margin-top:10px">
            <div class="flex">
              <button id="toggleCompact" class="btn ghost">Kompaktmodus</button>
              <button id="startTour" class="btn ghost">Geführte Tour starten</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- rechte Spalte: Metadaten & Buchtext -->
    <div class="right">
      <!-- neu oben: Metadaten -->
      <div class="row" style="margin-bottom:10px">
        <label for="rahmendaten">Rahmendaten / Metadaten (Eingabe verringert Zeichen je Kapitel proportional)</label>
        <textarea id="rahmendaten" placeholder="Autor, Absicht, Zielgruppe…"></textarea>
        <div class="meta">Zeichen (ohne Enter): <span id="rahmendatenCount">0</span></div>
      </div>

      <label for="text">Buch-Text (Eingaben abhängig vom aktuellen Kapitelsoll)</label>
      <div class="editor">
       <textarea id="text" placeholder="Füge hier deinen Text ein…"></textarea>
      </div>
    </div>
  </div>

  <!-- HUD, Tour & Script bleiben unverändert -->
  <div id="hud" class="hud" aria-live="polite">
    <div class="head">
      <div class="title">HUD</div>
      <div class="tools">
        <button id="hudCompactBtn" class="mini-btn" title="Kompaktmodus umschalten">Kompakt</button>
        <button id="hudHideBtn" class="mini-btn" title="HUD ein-/ausblenden">Hide</button>
        <button id="hudHelpBtn" class="mini-btn" title="Geführte Tour">?</button>
      </div>
    </div>
    <div class="rows" id="hudContent"></div>
  </div>

  <button id="toggleHud" class="btn secondary" aria-controls="hud" aria-expanded="true">
    HUD ausblenden
  </button>

  <div id="tour" class="tour" aria-live="polite" aria-modal="true">
    <div id="tourSpot" class="spot"></div>
    <div id="tourBox" class="box">
      <p id="tourText">Beschreibung</p>
      <div class="actions">
        <button id="tourSkip" class="btn secondary">Beenden</button>
        <button id="tourPrev" class="btn secondary">Zurück</button>
        <button id="tourNext" class="btn">Weiter</button>
      </div>
      <div class="small" id="tourProgress" style="margin-top:6px"></div>
    </div>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>
